{"version":3,"file":"AudioPlayer.js","sources":["../../../src/client/utils/getLink.ts","../../../src/client/components/AudioPlayer.ts"],"sourcesContent":["import { withBase } from \"@vuepress/client\";\nimport { isLinkHttp } from \"@vuepress/shared\";\n\nexport const getLink = (url: string): string =>\n  isLinkHttp(url) ? url : withBase(url);\n","import {\n  computed,\n  defineComponent,\n  h,\n  onBeforeMount,\n  onMounted,\n  ref,\n} from \"vue\";\nimport { getLink } from \"../utils/index.js\";\n\nimport type { Options as PlyrOptions } from \"plyr\";\nimport type { PropType, VNode } from \"vue\";\n\nimport \"plyr/dist/plyr.css\";\nimport \"../styles/audio-player.scss\";\n\nexport default defineComponent({\n  name: \"AudioPlayer\",\n\n  props: {\n    /** Options object for plyr config. **/\n    options: {\n      type: Object as PropType<PlyrOptions>,\n      default: () => ({}),\n    },\n\n    /**\n     * Audio source\n     *\n     * 音频源\n     */\n    src: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Audio title\n     *\n     * 音频标题\n     */\n    title: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Audio file type\n     *\n     * 音频文件类型\n     */\n    type: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Audio poster\n     *\n     * 音频封面\n     */\n    poster: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Whether to loop the video\n     *\n     * 是否循环播放\n     */\n    loop: Boolean,\n  },\n\n  setup(props) {\n    let player: Plyr | null = null;\n    const audio = ref<HTMLAudioElement>();\n\n    const plyrOptions = computed(() => ({\n      hideYouTubeDOMError: true,\n      ...props.options,\n    }));\n\n    onMounted(() => {\n      void import(\"plyr\").then(({ default: Plyr }) => {\n        if (audio.value) player = new Plyr(audio.value, plyrOptions.value);\n      });\n    });\n\n    onBeforeMount(() => {\n      try {\n        player?.destroy();\n      } catch (err: unknown) {\n        if (\n          !(\n            plyrOptions.value.hideYouTubeDOMError &&\n            (<Error>err).message ===\n              \"The YouTube player is not attached to the DOM.\"\n          )\n        )\n          console.error(err);\n      }\n    });\n\n    return (): VNode[] | null =>\n      props.src\n        ? [\n            h(\"div\", { class: \"audio-wrapper\" }, [\n              h(\n                \"a\",\n                { class: \"audio-print\", href: getLink(props.src) },\n                props.title || \"An audio\"\n              ),\n              props.poster\n                ? h(\"img\", {\n                    class: \"audio-poster\",\n                    src: getLink(props.poster),\n                  })\n                : null,\n              h(\"div\", { class: \"audio-info\" }, [\n                props.title\n                  ? h(\"div\", { class: \"audio-title\" }, props.title)\n                  : null,\n                h(\n                  \"audio\",\n                  {\n                    ref: audio,\n                    crossorigin: \"anonymous\",\n                    preload: \"metadata\",\n                    controls: \"\",\n                    ...(props.loop ? { loop: \"\" } : {}),\n                  },\n                  h(\"source\", { src: getLink(props.src), type: props.type })\n                ),\n              ]),\n            ]),\n          ]\n        : null;\n  },\n});\n"],"names":["getLink","url","isLinkHttp","withBase","AudioPlayer","defineComponent","props","player","audio","ref","plyrOptions","computed","onMounted","Plyr","onBeforeMount","err","h"],"mappings":"8RAGa,MAAAA,EAAWC,GACtBC,EAAWD,CAAG,EAAIA,EAAME,EAASF,CAAG,ECYtC,IAAAG,EAAeC,EAAgB,CAC7B,KAAM,cAEN,MAAO,CAEL,QAAS,CACP,KAAM,OACN,QAAS,KAAO,CAClB,EAAA,EAOA,IAAK,CACH,KAAM,OACN,SAAU,EACZ,EAOA,MAAO,CACL,KAAM,OACN,QAAS,EACX,EAOA,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,OAAQ,CACN,KAAM,OACN,QAAS,EACX,EAOA,KAAM,OACR,EAEA,MAAMC,EAAO,CACX,IAAIC,EAAsB,KAC1B,MAAMC,EAAQC,EAAsB,EAE9BC,EAAcC,EAAS,KAAO,CAClC,oBAAqB,GACrB,GAAGL,EAAM,OACX,EAAE,EAEF,OAAAM,EAAU,IAAM,CACT,OAAO,QAAQ,KAAK,CAAC,CAAE,QAASC,CAAK,IAAM,CAC1CL,EAAM,QAAOD,EAAS,IAAIM,EAAKL,EAAM,MAAOE,EAAY,KAAK,EACnE,CAAC,CACH,CAAC,EAEDI,EAAc,IAAM,CAClB,GAAI,CACFP,GAAA,MAAAA,EAAQ,QACV,CAAA,OAASQ,EAAT,CAGML,EAAY,MAAM,qBACVK,EAAK,UACX,kDAGJ,QAAQ,MAAMA,CAAG,CACrB,CACF,CAAC,EAEM,IACLT,EAAM,IACF,CACEU,EAAE,MAAO,CAAE,MAAO,eAAgB,EAAG,CACnCA,EACE,IACA,CAAE,MAAO,cAAe,KAAMhB,EAAQM,EAAM,GAAG,CAAE,EACjDA,EAAM,OAAS,UACjB,EACAA,EAAM,OACFU,EAAE,MAAO,CACP,MAAO,eACP,IAAKhB,EAAQM,EAAM,MAAM,CAC3B,CAAC,EACD,KACJU,EAAE,MAAO,CAAE,MAAO,YAAa,EAAG,CAChCV,EAAM,MACFU,EAAE,MAAO,CAAE,MAAO,aAAc,EAAGV,EAAM,KAAK,EAC9C,KACJU,EACE,QACA,CACE,IAAKR,EACL,YAAa,YACb,QAAS,WACT,SAAU,GACV,GAAIF,EAAM,KAAO,CAAE,KAAM,EAAG,EAAI,CAAA,CAClC,EACAU,EAAE,SAAU,CAAE,IAAKhB,EAAQM,EAAM,GAAG,EAAG,KAAMA,EAAM,IAAK,CAAC,CAC3D,CACF,CAAC,CACH,CAAC,CACH,EACA,IACR,CACF,CAAC"}