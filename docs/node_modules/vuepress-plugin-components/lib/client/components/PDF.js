import{ref as g,computed as T,unref as f,onMounted as w,isRef as N,watch as S,defineComponent as D,h as F}from"vue";import{useEventListener as v}from"@vueuse/core";import{withBase as b}from"@vuepress/client";import{isLinkHttp as L,ensureEndingSlash as $}from"@vuepress/shared";import{checkIsMobile as C,checkIsSafari as I}from"vuepress-shared/client";import"../styles/pdf.scss";const y=e=>typeof e=="string"?e:`${e}px`,x=(e,t=0)=>{const n=g(),i=T(()=>y(f(e.width)||"100%")),s=g("auto"),a=r=>{if(typeof r=="string"){const[d,u]=r.split(":"),p=Number(d)/Number(u);if(!Number.isNaN(p))return p}return typeof r=="number"?r:16/9},l=r=>{const d=f(e.height),u=a(f(e.ratio));return d?y(d):`${Number(r)/u+f(t)}px`},o=()=>{n.value&&(s.value=l(n.value.clientWidth))};return w(()=>{o(),N(t)&&S(t,()=>o()),v("orientationchange",()=>o()),v("resize",()=>o())}),{el:n,width:i,height:s}},R=e=>L(e)?e:b(e),c=e=>{console.error("[PDF]: "+e)},E=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},M=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,U=e=>{let t="";return e&&(t+=Object.entries(e).map(([n,i])=>n==="noToolbar"?`toolbar=${i?0:1}`:`${encodeURIComponent(n)}=${encodeURIComponent(i)}`).join("&"),t&&(t="#"+t,t=t.slice(0,t.length-1))),t},P=(e,t,n,i,s)=>{E(t);let a=n;e==="pdfjs"&&(a=`${`${$(b(PDFJS_URL))}web/viewer.html`}?file=${encodeURIComponent(n)}${U(i)}`);const l=e==="pdfjs"||e==="iframe"?"iframe":"embed",o=document.createElement(l);return o.className="pdf-viewer",o.type="application/pdf",o.title=s,o.src=a,o instanceof HTMLIFrameElement&&(o.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(o),t.getElementsByTagName(l)[0]},j=(e,t=null,{title:n,options:i={}})=>{var s;if(typeof window>"u"||window.navigator===void 0||window.navigator.userAgent===void 0||window.navigator.mimeTypes===void 0)return null;const a=window.navigator,l=window.navigator.userAgent,o=window.Promise!==void 0,r=a.platform!==void 0&&a.platform==="MacIntel"&&a.maxTouchPoints!==void 0&&a.maxTouchPoints>1||C(l),d=!r&&I(l),u=!r&&/irefox/.test(l)&&l.split("rv:").length>1?parseInt(l.split("rv:")[1].split(".")[0],10)>18:!1,p=!r&&(o||u);if(typeof e!="string")return c("URL is not valid"),null;const m=M(t);if(!m)return c("Target element cannot be determined"),null;const h=n||((s=/\/([^/]+).pdf/.exec(e))==null?void 0:s[1])||"PDF Viewer";return p||!r?P(d?"iframe":"embed",m,e,i,h):PDFJS_URL?P("pdfjs",m,e,i,h):(m.innerHTML="<p>This browser does not support inline PDFs. Please download the PDF to view it: <a href='[url]' target='_blank'>Download PDF</a></p>".replace(/\[url\]/g,e),c("This browser does not support embedded PDFs"),null)};var k=D({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,zoom:{type:[String,Number],default:100}},setup(e){const{el:t,width:n,height:i}=x(e);return w(()=>{j(R(e.url),t.value,{title:e.title,options:{page:e.page,noToolbar:e.noToolbar,zoom:e.zoom}})}),()=>F("div",{class:"pdf-preview",ref:t,style:{width:n.value,height:i.value}})}});export{k as default};
//# sourceMappingURL=PDF.js.map
