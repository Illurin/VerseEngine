{"version":3,"file":"theme.js","sourceRoot":"","sources":["../../src/node/theme.ts"],"names":[],"mappings":"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","sourcesContent":["import { watch } from \"chokidar\";\n\nimport { resolveAlias } from \"./alias.js\";\nimport { extendsBundlerOptions } from \"./bundler.js\";\nimport { checkStyle, convertThemeOptions } from \"./compact/index.js\";\nimport {\n  checkSocialMediaIcons,\n  getStatus,\n  getThemeData,\n} from \"./config/index.js\";\nimport { getPluginConfig, usePlugin } from \"./plugins/index.js\";\nimport {\n  prepareConfigFile,\n  prepareSidebarData,\n  prepareSocialMediaIcons,\n  prepareThemeColorScss,\n} from \"./prepare/index.js\";\nimport { TEMPLATE_FOLDER } from \"./utils.js\";\n\nimport type { ThemeFunction } from \"@vuepress/core\";\nimport type { ThemeOptions } from \"../shared/index.js\";\n\nexport const hopeTheme =\n  (\n    options: ThemeOptions,\n    // TODO: Remove this in v2 stable\n    legacy = false\n  ): ThemeFunction =>\n  (app) => {\n    const { isDebug } = app.env;\n    const {\n      hotReload = isDebug,\n      plugins = {},\n      hostname,\n      iconAssets,\n      iconPrefix,\n      backToTop,\n      sidebarSorter,\n      ...themeOptions\n    } = legacy\n      ? convertThemeOptions(options as ThemeOptions & Record<string, unknown>)\n      : options;\n\n    if (legacy) checkStyle(app);\n\n    const status = getStatus(app, options);\n    const themeConfig = getThemeData(app, themeOptions, status);\n    const icons = status.enableBlog ? checkSocialMediaIcons(themeConfig) : {};\n\n    usePlugin(app, plugins, legacy, hotReload);\n\n    if (isDebug) console.log(\"Theme plugin options:\", plugins);\n\n    return {\n      name: \"vuepress-theme-hope\",\n\n      alias: resolveAlias(isDebug),\n\n      define: () => ({\n        BLOG_TYPE_INFO: status.blogType,\n        ENABLE_BLOG: status.enableBlog,\n        ENABLE_READING_TIME: status.enableReadingTime,\n        HAS_MULTIPLE_LANGUAGES: status.hasMultipleLanguages,\n        SUPPORT_PAGEVIEW: status.supportPageview,\n      }),\n\n      extendsBundlerOptions,\n\n      onPrepared: (): Promise<void> =>\n        Promise.all([\n          prepareSidebarData(app, themeConfig, sidebarSorter),\n          prepareThemeColorScss(app, themeConfig),\n          prepareSocialMediaIcons(app, icons),\n        ]).then(() => void 0),\n\n      onWatched: (app, watchers): void => {\n        if (hotReload) {\n          // this ensure the page is generated or updated\n          const structureSidebarWatcher = watch(\"pages/**/*.vue\", {\n            cwd: app.dir.temp(),\n            ignoreInitial: true,\n          });\n\n          structureSidebarWatcher.on(\"add\", () => {\n            void prepareSidebarData(app, themeConfig, sidebarSorter);\n          });\n          structureSidebarWatcher.on(\"change\", () => {\n            void prepareSidebarData(app, themeConfig, sidebarSorter);\n          });\n          structureSidebarWatcher.on(\"unlink\", () => {\n            void prepareSidebarData(app, themeConfig, sidebarSorter);\n          });\n\n          watchers.push(structureSidebarWatcher);\n        }\n      },\n\n      plugins: getPluginConfig(\n        app,\n        plugins,\n        themeConfig,\n\n        // @ts-ignore\n        {\n          backToTop,\n          hostname,\n          hotReload,\n          iconAssets,\n          iconPrefix,\n        },\n        legacy\n      ),\n\n      templateBuild: `${TEMPLATE_FOLDER}index.build.html`,\n\n      clientConfigFile: (app) => prepareConfigFile(app, status),\n    };\n  };\n"]}